<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart Dashboard</title>
  <style>
    :root {
      --bg-color: #1a1a2e;
      --text-color: #ffffff;
    }

    body {
      margin: 0;
      padding: 2vh;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      gap: 3vh;
      box-sizing: border-box;
      transition: background 2s ease-in-out, color 1s ease-in-out;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 3vh;
      justify-content: space-between;
      width: 100%;
    }

    .widget {
      font-weight: 300; /* lighter */
      font-size: 2.5vw;
      margin-bottom: 1vh;
      flex-grow: 1;
      min-width: 30%;
      flex-basis: 30%;
      background: rgba(255, 255, 255, 0.05);
      padding: 2vh;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      box-sizing: border-box;
    }

    .thin-row .widget {
      flex-basis: 32%;
      min-width: 32%;
      height: 6vh;
    }

    .full-width {
      flex-basis: 100%;
    }

    .clock {
      font-size: 6vw;
      font-weight: bold;
      text-align: right;
    }

    .date {
      text-align: right;
      font-size: 2vw;
      font-weight: bold;
    }

    .weather {
      font-size: 2.5vw;
      font-weight: 500;
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: left;
    }

    .weather img {
      height: auto;
      width: 60px;
    }

    ul {
      list-style: none;
      padding-left: 0;
    }

    input[type="text"] {
      padding: 1vh;
      font-size: 2vw;
      width: 70%;
      border-radius: 10px;
      border: none;
    }

    button {
      padding: 1vh 2vh;
      font-size: 2vw;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }

    li {
      font-size: 2vw;
      margin-top: 1vh;
    }

    @media (max-width: 768px) {
      .widget {
        flex-basis: 100% !important;
        min-width: 100% !important;
      }
    }
  </style>
</head>
<body>
  <div class="row">
    <div class="widget weather" id="weather">Loading weather...</div>
    <div class="widget clock">
      <div id="clock"></div>
      <div class="date" id="date"></div>
    </div>
  </div>

  <div class="row">
    <div class="widget full-width">
      <h2>Grocery List</h2>
      <input type="text" id="item-input" placeholder="Add item..." />
      <button onclick="addItem()">Add</button>
      <ul id="items"></ul>
    </div>
  </div>

  <div class="row">
    <div class="widget full-width">
      <h2>To-Do List</h2>
      <input type="text" id="todo-input" placeholder="Add task..." />
      <button onclick="addTask()">Add</button>
      <ul id="todo-list"></ul>
    </div>
  </div>

  <div class="row">
    <div class="widget"></div>
    <div class="widget"></div>
    <div class="widget"></div>
    <div class="widget"></div>
  </div>

  <div class="row thin-row">
    <div class="widget"></div>
    <div class="widget"></div>
    <div class="widget"></div>
  </div>

  <script>
    function updateClock() {
      const now = new Date();
      document.getElementById("clock").textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      document.getElementById("date").textContent = now.toDateString();
    }

    setInterval(updateClock, 1000);
    updateClock();

    const apiKey = "464ada6dae3151b0fb9bbf18cba7bec4";
    const lat = 59.3293;
    const lon = 18.0686;

    fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`)
      .then(res => res.json())
      .then(data => {
        const temp = Math.round(data.main.temp);
        const icon = data.weather[0].icon;
        const desc = data.weather[0].description;
        document.getElementById("weather").innerHTML = `<img src='https://openweathermap.org/img/wn/${icon}@2x.png'> ${temp}°C <br><span>${desc}</span>`;
      })
      .catch(() => {
        document.getElementById("weather").textContent = "Weather unavailable";
      });

    let items = JSON.parse(localStorage.getItem("groceryList")) || [];
    function saveItems() {
      localStorage.setItem("groceryList", JSON.stringify(items));
    }
    function renderItems() {
      const list = document.getElementById("items");
      list.innerHTML = "";
      items.forEach((item, index) => {
        const li = document.createElement("li");
        li.textContent = item;
        const btn = document.createElement("button");
        btn.textContent = "❌";
        btn.onclick = () => {
          items.splice(index, 1);
          saveItems();
          renderItems();
        };
        li.appendChild(btn);
        list.appendChild(li);
      });
    }
    function addItem() {
      const input = document.getElementById("item-input");
      if (input.value.trim()) {
        items.push(input.value.trim());
        input.value = "";
        saveItems();
        renderItems();
      }
    }
    renderItems();

    let todos = JSON.parse(localStorage.getItem("todoList")) || [];
    function saveTodos() {
      localStorage.setItem("todoList", JSON.stringify(todos));
    }
    function renderTodos() {
      const list = document.getElementById("todo-list");
      list.innerHTML = "";
      todos.forEach((item, index) => {
        const li = document.createElement("li");
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.checked = item.done;
        checkbox.onchange = () => {
          item.done = checkbox.checked;
          saveTodos();
        };
        li.appendChild(checkbox);
        li.appendChild(document.createTextNode(" " + item.text));
        list.appendChild(li);
      });
    }
    function addTask() {
      const input = document.getElementById("todo-input");
      if (input.value.trim()) {
        todos.push({ text: input.value.trim(), done: false });
        input.value = "";
        saveTodos();
        renderTodos();
      }
    }
    renderTodos();

    function updateBackground() {
      const hour = new Date().getHours();
      let bg = '#1a1a2e';
      let textColor = '#fff';

      if (hour >= 5 && hour < 8) bg = 'linear-gradient(to right, #000428, #004e92)';
      else if (hour >= 8 && hour < 12) bg = 'linear-gradient(to right, #2980b9, #6dd5fa)';
      else if (hour >= 12 && hour < 17) bg = 'linear-gradient(to right, #fceabb, #f8b500)';
      else if (hour >= 17 && hour < 20) bg = 'linear-gradient(to right, #2c3e50, #fd746c)';
      else bg = 'linear-gradient(to right, #0f2027, #203a43, #2c5364)';

      if (hour >= 10 && hour <= 15) textColor = '#000';
      else textColor = '#fff';

      document.body.style.background = bg;
      document.body.style.color = textColor;
      document.documentElement.style.setProperty('--text-color', textColor);
    }

    updateBackground();
    setInterval(updateBackground, 60 * 60 * 1000);
  </script>
</body>
</html>
